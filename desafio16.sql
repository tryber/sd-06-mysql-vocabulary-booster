DELIMITER $$ CREATE FUNCTION buscar_quantidade_de_empregos_por_funcionario(email VARCHAR(50)) RETURNS INT READS SQL DATA BEGIN DECLARE totalJobs INT; SELECT COUNT(`Tabelao`.EMPLOYEE_ID) FROM (SELECT J.EMPLOYEE_ID, EMP.EMAIL FROM hr.employees AS EMP INNER JOIN hr.job_history AS J ON EMP.EMPLOYEE_ID = J.EMPLOYEE_ID AND EMP.EMAIL = email) AS `Tabelao` INTO totalJobs; RETURN totalJobs; END $$