SELECT T_JOB.JOB_TITLE AS Cargo, ROUND(AVG(T_EMP.SALARY), 2) AS 'Média salarial',
CASE
WHEN ROUND(AVG(T_EMP.SALARY), 2)>=2000 AND ROUND(AVG(T_EMP.SALARY), 2)<=5800 THEN "Júnior"
WHEN ROUND(AVG(T_EMP.SALARY), 2)>=5801 AND ROUND(AVG(T_EMP.SALARY), 2)<=7500 THEN "Pleno"
WHEN ROUND(AVG(T_EMP.SALARY), 2)>=7501 AND ROUND(AVG(T_EMP.SALARY), 2)<=10500 THEN "Sênior"
WHEN ROUND(AVG(T_EMP.SALARY), 2)>10500 THEN "CEO"
ELSE 'Não classificado'
END
AS Senioridade
FROM hr.jobs AS T_JOB
INNER JOIN hr.employees AS T_EMP
ON T_JOB.JOB_ID = T_EMP.JOB_ID
GROUP BY JOB_TITLE
ORDER BY ROUND(AVG(T_EMP.SALARY), 2), JOB_TITLE;
